p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +
geom_point(color = "yellow", size = 0.15) +
ggtitle(paste("Centre Of Mass with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = COM_X, yend = COM_Y),
arrow = arrow(length = unit(0.01, "npc")),
color  = "red")
print(p)
ggsave("ggsave.pdf", width = 6.9, height = 7)  # save individual plot
setwd("~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred")
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
View(Channel_5)
View(Channel_9)
View(Channel_1)
View(Channel_8)
View(p)
View(transform_zernike_to_vector_end)
ggsave()
getwd()
getwd()
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +
geom_point(color = "yellow", size = 0.15) +
ggtitle(paste("Zernike with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = Zernike_X, yend = Zernike_Y),
arrow = arrow(length = unit(0.002, "npc")),
color = "red")
print(p)
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
debugSource('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
setwd("~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred")
setwd("~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred")
str_name<-'/media/user/Windows/Users/Main User/Documents/IMC/8. Head & Neck/ImcSegmentationPipeline/output/cpout/Overlay.tiff'
library(tiff)
image <- readTIFF(str_name)
grob <- rasterGrob(image, interpolate=TRUE)
debugSource('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
debugSource('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
debugSource('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +r
geom_point(color = "yellow", size = 0.005) +
ggtitle(paste("Zernike with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = Zernike_X, yend = Zernike_Y),
arrow = arrow(length = unit(0.0006, "npc")), size = 0.006,
color = "red")
print(p)
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +
geom_point(color = "yellow", size = 0.15) +
ggtitle(paste("Centre Of Mass with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = COM_X, yend = COM_Y),
arrow = arrow(length = unit(0.01, "npc")),
color  = "red")
print(p)
ggsave("ggsave.pdf", width = 6.9, height = 7)  # save individual plot
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
pdf("plots.pdf", width = 6.9, height = 7)
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +r
geom_point(color = "yellow", size = 0.005) +
ggtitle(paste("Zernike with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = Zernike_X, yend = Zernike_Y),
arrow = arrow(length = unit(0.0006, "npc")), size = 0.006,
color = "red")
print(p)
#for (channel in channel_list){      # all channels  in the list)
for (channel in channel_list[1:1]){   # only first channel
data <- get(channel)
roi <- subset_roi(data, 100, 400, 200, 200)
# plot subset with arrows towards the centre of mass
p <- ggplot(roi, aes(X, Y)) +
scale_y_reverse() +
theme_classic() +
geom_point() +
ggtitle(paste("Centre Of Mass:", channel)) +
geom_segment(aes(x = X, y = Y, xend = COM_X, yend = COM_Y),
arrow = arrow(length = unit(0.01, "npc")),
color = "red")
print(p)
# plot subset with arrows towards the Zernike coord
p <- ggplot(roi, aes(X, Y)) +
scale_y_reverse() +
theme_classic() +
geom_point() +
ggtitle(paste("Zernike:", channel)) +
geom_segment(aes(x = X, y = Y, xend = Zernike_X, yend = Zernike_Y),
arrow = arrow(length = unit(0.01, "npc")),
color = "red")
print(p)
#plot Centre OF Mass with mask
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +
geom_point(color = "yellow", size = 0.15) +
ggtitle(paste("Centre Of Mass with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = COM_X, yend = COM_Y),
arrow = arrow(length = unit(0.01, "npc")),
color  = "red")
print(p)
# ggsave("ggsave.pdf", width = 6.9, height = 7)  # save individual plot
pdf("plots.pdf", width = 6.9, height = 7)
#plot Zernike with mask
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +r
geom_point(color = "yellow", size = 0.005) +
ggtitle(paste("Zernike with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = Zernike_X, yend = Zernike_Y),
arrow = arrow(length = unit(0.0006, "npc")), size = 0.006,
color = "red")
print(p)
}
dev.off()
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +
geom_point(color = "yellow", size = 0.15) +
ggtitle(paste("Centre Of Mass with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = COM_X, yend = COM_Y),
arrow = arrow(length = unit(0.01, "npc")),
color  = "red")
print(p)
ggsave("ggsave.pdf", width = 6.9, height = 7)  # save individual plot
p <- ggplot(data, aes(X, Y)) +
annotation_custom(grob = grob, xmin=0, xmax=1000, ymin=0, ymax=-1000) +
scale_y_reverse() +
theme_classic() +
geom_point(color = "yellow", size = 0.15) +
ggtitle(paste("Centre Of Mass with Mask:", channel)) +
geom_segment(aes(x = X, y = Y, xend = COM_X, yend = COM_Y),
arrow = arrow(length = unit(0.01, "npc")),
color  = "red")
print(p)
ggsave("ggsave.pdf", width = 6.9, height = 7)  # save individual plot
debugSource('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
debugSource('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
r=
r
# Function to calculate coordinates for arrow heads based on Zerike 1,1 magnitude and phase
# polar to cartesian conversion
# scale_factor can be a vector
transform_zernike_to_vector_end <- function (data, scale_factor = 0, max_length = 30)
{
r <- data$ZernikeMagnitude_1_1
theta <- data$ZernikePhase_1_1
# calculate vector
data$Zernike_X <- r * cos(theta)
data$Zernike_Y <- r * sin(theta)
if (scale_factor == 0) {
# if scale factor is zero, calculate it from the max length
max_mag <- max(data$ZernikeMagnitude_1_1, na.rm = T)
scale_factor <- max_length / max_mag
}
# scale and place vector in the image coord system
data$Zernike_X <- scale_factor * data$Zernike_X + data$X
data$Zernike_Y <- scale_factor * data$Zernike_Y + data$Y
return(data)
}
# make a subset of cells in an roi
subset_roi <- function (data, x, y, width, height)
{
x_max <- x + width
y_max <- y + height
data <- subset(data, X < x_max)
data <- subset(data, X > x)
data <- subset(data, Y < y_max)
data <- subset(data, Y > y)
return(data)
}
r
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
r <- data$ZernikeMagnitude_1_1
r
source('~/Documents/channels_split_cellprofiler_headless/Output_Channels_Split_Transferred/plot_vectors_all_channels.R')
View(transform_zernike_to_vector_end)
View(transform_zernike_to_vector_end)
View(transform_zernike_to_vector_end)
View(transform_zernike_to_vector_end)
View(transform_zernike_to_vector_end)
